import{a as y,u as C,f as k,r as w,j as e,S as u}from"./index.v2-7c3d67aa.js";import{C as m,b as p,B as b,a as E}from"./Card-631a1429.js";const h=({title:s,description:r,children:n})=>e.jsxs(m,{children:[e.jsxs(E,{children:[e.jsx("h3",{className:"text-lg font-semibold",children:s}),r&&e.jsx("p",{className:"text-sm text-theme-secondary",children:r})]}),e.jsx(p,{children:n})]}),l=({label:s,description:r,children:n})=>e.jsxs("div",{className:"flex items-center justify-between py-3 border-b border-theme last:border-b-0",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-medium text-theme",children:s}),r&&e.jsx("div",{className:"text-sm text-theme-secondary",children:r})]}),e.jsx("div",{className:"ml-4",children:n})]}),S=()=>{const{data:s,isLoading:r,error:n,updateConfig:j}=y(),{data:a,isLoading:N}=C(),{state:c,dispatch:x}=k(),[d,i]=w.useState(!1),g=async t=>{i(!0);try{await j({mode:t})}catch(o){console.error("Failed to update mode:",o)}finally{i(!1)}},v=async t=>{i(!0);try{await j({"log-level":t})}catch(o){console.error("Failed to update log level:",o)}finally{i(!1)}},f=async t=>{i(!0);try{await j({"allow-lan":t})}catch(o){console.error("Failed to update allow-lan:",o)}finally{i(!1)}};return r?e.jsxs("div",{className:"space-y-6",children:[e.jsx("h1",{className:"text-2xl font-bold text-theme",children:"配置"}),e.jsx(m,{children:e.jsx(p,{children:e.jsxs("div",{className:"animate-pulse space-y-4",children:[e.jsx("div",{className:"h-4 bg-gray-200 dark:bg-gray-700 rounded w-1/4"}),e.jsx("div",{className:"h-4 bg-gray-200 dark:bg-gray-700 rounded w-1/2"})]})})})]}):n?e.jsxs("div",{className:"space-y-6",children:[e.jsx("h1",{className:"text-2xl font-bold text-theme",children:"配置"}),e.jsx(m,{children:e.jsx(p,{children:e.jsxs("div",{className:"text-center py-8",children:[e.jsx("h3",{className:"text-lg font-medium text-theme mb-2",children:"加载失败"}),e.jsx("p",{className:"text-theme-secondary mb-4",children:String(n)}),e.jsx(b,{onClick:()=>window.location.reload(),children:"重试"})]})})})]}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-theme",children:"配置"}),e.jsx("p",{className:"text-theme-secondary",children:"管理 Clash 核心配置和应用设置"})]}),e.jsx(u,{status:d?"info":"success",label:d?"保存中...":"已同步"})]}),e.jsx(h,{title:"系统信息",description:"Clash 核心版本和运行状态信息",children:e.jsxs("div",{className:"space-y-0",children:[e.jsx(l,{label:"Clash 版本",description:"当前运行的 Clash 核心版本",children:N?e.jsx("div",{className:"w-24 h-4 bg-gray-200 dark:bg-gray-700 rounded animate-pulse"}):e.jsx("span",{className:"text-theme font-mono",children:(a==null?void 0:a.version)||"N/A"})}),e.jsx(l,{label:"版本类型",description:"是否为高级版本",children:N?e.jsx("div",{className:"w-16 h-4 bg-gray-200 dark:bg-gray-700 rounded animate-pulse"}):e.jsx("span",{className:`px-2 py-1 text-xs rounded-full ${a!=null&&a.premium?"bg-green-100 dark:bg-green-900/20 text-green-700 dark:text-green-400":"bg-gray-100 dark:bg-gray-900/20 text-gray-700 dark:text-gray-400"}`,children:a!=null&&a.premium?"高级版":"开源版"})}),(a==null?void 0:a.platform)&&e.jsx(l,{label:"平台",description:"系统平台信息",children:e.jsxs("span",{className:"text-theme font-mono",children:[a.platform," ",a.arch&&`(${a.arch})`]})}),(a==null?void 0:a.stack)&&e.jsx(l,{label:"网络栈",description:"TCP/IP 栈类型",children:e.jsx("span",{className:"text-theme font-mono",children:a.stack})})]})}),e.jsx(h,{title:"Clash 核心配置",description:"这些设置会直接影响 Clash 核心的行为",children:e.jsxs("div",{className:"space-y-0",children:[e.jsx(l,{label:"代理模式",description:"选择流量处理方式",children:e.jsxs("select",{value:(s==null?void 0:s.mode)||"rule",onChange:t=>g(t.target.value),disabled:d,className:"px-3 py-2 border border-theme rounded-md bg-surface text-theme disabled:opacity-50",children:[e.jsx("option",{value:"rule",children:"规则模式"}),e.jsx("option",{value:"global",children:"全局模式"}),e.jsx("option",{value:"direct",children:"直连模式"})]})}),e.jsx(l,{label:"日志级别",description:"控制日志输出的详细程度",children:e.jsxs("select",{value:(s==null?void 0:s["log-level"])||"info",onChange:t=>v(t.target.value),disabled:d,className:"px-3 py-2 border border-theme rounded-md bg-surface text-theme disabled:opacity-50",children:[e.jsx("option",{value:"silent",children:"静默"}),e.jsx("option",{value:"error",children:"错误"}),e.jsx("option",{value:"warning",children:"警告"}),e.jsx("option",{value:"info",children:"信息"}),e.jsx("option",{value:"debug",children:"调试"})]})}),e.jsx(l,{label:"允许局域网连接",description:"允许其他设备通过局域网使用代理",children:e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",checked:(s==null?void 0:s["allow-lan"])||!1,onChange:t=>f(t.target.checked),disabled:d,className:"rounded disabled:opacity-50"}),e.jsx("span",{className:"ml-2 text-sm",children:"启用"})]})}),e.jsx(l,{label:"HTTP 端口",description:"HTTP 代理服务端口",children:e.jsx("span",{className:"text-theme font-mono",children:(s==null?void 0:s.port)||"N/A"})}),e.jsx(l,{label:"SOCKS 端口",description:"SOCKS5 代理服务端口",children:e.jsx("span",{className:"text-theme font-mono",children:(s==null?void 0:s["socks-port"])||"N/A"})}),e.jsx(l,{label:"混合端口",description:"HTTP 和 SOCKS5 混合端口",children:e.jsx("span",{className:"text-theme font-mono",children:(s==null?void 0:s["mixed-port"])||"N/A"})})]})}),e.jsx(h,{title:"应用设置",description:"YACD V2 界面和行为设置",children:e.jsxs("div",{className:"space-y-0",children:[e.jsx(l,{label:"自动刷新",description:"自动刷新数据和状态",children:e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",checked:c.preferences.autoRefresh,onChange:t=>x({type:"UPDATE_PREFERENCES",payload:{autoRefresh:t.target.checked}}),className:"rounded"}),e.jsx("span",{className:"ml-2 text-sm",children:"启用"})]})}),e.jsx(l,{label:"刷新间隔",description:"数据自动刷新的时间间隔（毫秒）",children:e.jsxs("select",{value:c.preferences.refreshInterval,onChange:t=>x({type:"UPDATE_PREFERENCES",payload:{refreshInterval:parseInt(t.target.value)}}),className:"px-3 py-2 border border-theme rounded-md bg-surface text-theme",children:[e.jsx("option",{value:1e3,children:"1 秒"}),e.jsx("option",{value:3e3,children:"3 秒"}),e.jsx("option",{value:5e3,children:"5 秒"}),e.jsx("option",{value:1e4,children:"10 秒"})]})}),e.jsx(l,{label:"显示通知",description:"显示系统通知和提醒",children:e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",checked:c.preferences.showNotifications,onChange:t=>x({type:"UPDATE_PREFERENCES",payload:{showNotifications:t.target.checked}}),className:"rounded"}),e.jsx("span",{className:"ml-2 text-sm",children:"启用"})]})}),e.jsx(l,{label:"紧凑模式",description:"使用更紧凑的界面布局",children:e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",checked:c.preferences.compactMode,onChange:t=>x({type:"UPDATE_PREFERENCES",payload:{compactMode:t.target.checked}}),className:"rounded"}),e.jsx("span",{className:"ml-2 text-sm",children:"启用"})]})})]})}),e.jsx(h,{title:"API 连接信息",description:"当前连接的 Clash API 信息",children:e.jsxs("div",{className:"space-y-0",children:[e.jsx(l,{label:"API 地址",description:"Clash API 服务地址",children:e.jsx("span",{className:"text-theme font-mono",children:c.apiConfig.baseURL})}),e.jsx(l,{label:"认证密钥",description:"API 访问密钥",children:e.jsx("span",{className:"text-theme font-mono",children:c.apiConfig.secret?"••••••••":"未设置"})}),e.jsx(l,{label:"连接状态",description:"与 Clash API 的连接状态",children:e.jsx(u,{status:s?"success":"error",label:s?"已连接":"连接失败"})})]})}),e.jsx(h,{title:"系统信息",description:"Clash 核心和应用版本信息",children:e.jsxs("div",{className:"space-y-0",children:[e.jsx(l,{label:"Clash 版本",description:"当前运行的 Clash 核心版本",children:e.jsx("span",{className:"text-theme font-mono",children:a.version})}),e.jsx(l,{label:"YACD 版本",description:"当前 YACD V2 版本",children:e.jsx("span",{className:"text-theme font-mono",children:"2.0.0-dev"})}),e.jsx(l,{label:"Premium 功能",description:"是否支持 Premium 功能",children:e.jsx(u,{status:a.premium?"success":"warning",label:a.premium?"支持":"不支持"})})]})}),e.jsx(m,{children:e.jsx(p,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-theme",children:"危险操作"}),e.jsx("p",{className:"text-sm text-theme-secondary",children:"这些操作可能会影响系统运行，请谨慎使用"})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(b,{variant:"outline",size:"sm",onClick:()=>{confirm("确定要重置所有 V2 设置吗？")&&(localStorage.removeItem("v2-preferences"),window.location.reload())},children:"重置设置"}),e.jsx(b,{variant:"outline",size:"sm",onClick:()=>{confirm("确定要重启 Clash 核心吗？")&&console.log("Restart Clash core")},children:"重启核心"})]})]})})})]})};export{S as Config};
